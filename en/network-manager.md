## NetworkManager class
The `NetworkManager` class defines the interface required for managing the network system in Robot Devastation. Other classes can then define the implementation of the NetworkManager according to, for instance, the library selected for connecting to the network / server.

{% plantuml %}
interface NetworkManager {
--Startup & Halting--
bool start()
bool stop()
bool isStopped()
-- Configuration & Listeners --
bool addNetworkEventListener(RdNetworkEventListener * listener)
bool removeNetworkEventListeners()
bool configure(string parameter, RdPlayer value)
-- Communications with server --
bool login()
bool logout()
bool keepAlive()
bool sendPlayerHit(RdPlayer player, int damage)
-- RdMentalMapEventListener interface --
onTargetHit(RdTarget target, RdPlayer player, RdWeapon weapon)
onRespawn(RdPlayer player)
}

interface RdMentalMapEventListener
RdMentalMapEventListener <|-- NetworkManager

{% endplantuml %}

The main methods of an `NetworkManager` are: 
* `start()`, `stop()` and `isStopped()`: control the manager startup and halting.
* `addNetworkEventListener()`: registers a `RdNetworkEventListener` that will be notified when network events are generated by the server.
* `removeNetworkEventListeners()`: unsuscribes all the registered listeners, and they will not be notified until they are registered again.
* `configure()`: configure some network parameters (e.g. the player to be logged in).
* `login()`: login in the game server.
* `logout()`: logout from the game server.
* `keepAlive()`: tells the server that you are still alive. If this signal is not sent every 60 seconds the server automatically logs out the player.
* `sendPlayerhit()`: notify the server that an enemy has been hit.

A `NetworkManager` should also implement the required methods of the `RdMentalMapEventListener` interface:
* `onTargetHit()`: notifies the game server that a player has been hit with `sendPlayerhit()`.
* `onRespawn()`: restores the player health after respawn.


## YarpNetworkManager class
`YarpNetworkManager` is an implementation of the `NetworkManager` interface using [YARP](http://www.yarp.it/) as communications middleware. It uses a `yarp::os::TypedReaderCallback<yarp::os::Bottle>` to receive data from the server and then notifies listeners that new data has arrived.

A `yarp::os::RateThread` is used to send periodically a `keepAlive()` signal to the game server to avoid being logged out.

## MockupNetworkManager class
`MockupNetworkManager` is an implementation of the `NetworkManager` for unit testing purposes.
It allows to emulate connections with [The Server](the-server.md) without the actual server being executed. It also allows reading / writing data to the emulated game server to check , for instance, if the player is logged in or to set the game players.
 
* `isLoggedIn()`: checks if player is currently logged in the server.
* `isStopped()`: checks if the manager is stopped.
* `setPlayerData()`: sets the player data in the emulated server.
* `getPlayerData()`: retrieves the player data from the emulated server.
* `sendPlayerData()`: makes the `MockupNetworkManager` receive player data from the emulated server. 
* `setLoggedIn()`: set the logged in status of the `MockupNetworkManager`.


{% plantuml %}

class MockupNetworkManager {
-- Mockup object API --
bool isLoggedIn()
bool isStopped()
bool setPlayerData(vector<RdPlayer> game_players)
vector<RdPlayer> getPlayerData()
bool sendPlayerData()
bool setLoggedIn(bool logged_in)
}
{% endplantuml %}





